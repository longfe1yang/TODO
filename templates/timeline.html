<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="Dashboard">
    <meta name="keyword" content="Dashboard, Bootstrap, Admin, Template, Theme, Responsive, Fluid, Retina">

    <title>TODO - HOST</title>

    <!-- Bootstrap core CSS -->
    <link href="../static/css/bootstrap.css" rel="stylesheet">
    <!--external css-->
    <link href="../static/font-awesome/css/font-awesome.css" rel="stylesheet"/>

    <!-- Custom styles for this template -->
    <link href="../static/css/style.css" rel="stylesheet">
    <link href="../static/css/style-responsive.css" rel="stylesheet">
    <link rel="stylesheet" href="../static/css/to-do.css">


    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>

    <script src="../static/js/jquery.js"></script>
    <script src="../static/js/bootstrap.min.js"></script>
    <script class="include" type="text/javascript" src="../static/js/jquery.dcjqaccordion.2.7.js"></script>
    <script src="../static/js/jquery.scrollTo.min.js"></script>
    <script src="../static/js/jquery.nicescroll.js" type="text/javascript"></script>

    <script src="../static/js/common-scripts.js"></script>

    <script src="http://code.jquery.com/ui/1.10.3/jquery-ui.js"></script>
    <script src="../static/js/tasks.js" type="text/javascript"></script>
    <script src="../static/js/jquery-3.0.0.min.js"></script>
    <script src="../static/js/api.js"></script>

    <script>
        window.g_userID = {{user.id}}
        var todoTemplate = function (todo) {
            var t = todo;
            var text = t.content;
            var id = t.id;
            var tt = `
            <li data-id=${t.id} class="node">
                <i class=" fa fa-ellipsis-v"></i>
                <div class="task-checkbox">
                    <input type="checkbox" class="list-child" value=""/>
                </div>
                <div class="task-title">
                    <span class="task-title-sp">${text}</span>
                    <!--<span class="badge bg-theme">Done</span>-->
                    <div class="pull-right hidden-phone">
                        <!--<button class="btn btn-success btn-xs fa fa-check" title="完成"></button>-->
                        <button class="btn btn-primary btn-xs fa fa-pencil" title="编辑"></button>
                        <button class="btn btn-danger btn-xs fa fa-trash-o long-button-delete" title="删除"></button>
                    </div>
                </div>
            </li>`;
            return tt
        };

        var insertTodos = function(todos){
            for(var i = 0; i < todos.length; i++) {
              var a = todos[i];
              var t = todoTemplate(a);
//              console.log('这里是insertTodos', t);
              $('#sortable').append(t);
          }
      };

        var loadTodos = function(){
//            console.log('这里是loadTodos');
            vip.todos(function(r){
              if(r.success){
                var todos = r.data;
                  console.log('loadTodos r.data', r.data);
                insertTodos(todos);
              } else {
                  alert(r.message);
              }
            }, g_userID);
//            因为vip.todo这个是两个参数，一个response，一个是id
        };

        var bindDeleteAction = function() {
            $('ul#sortable').on('click', 'button.long-button-delete',function(){
                log('this', $(this).data('id'));
                $(this).closest('li').remove()
                })};

        var initTaskWidget = function() {
            $('ul#sortable').on('click', 'input.list-child',function(){
                if ($(this).is(':checked')) {
                    $(this).parents('li').addClass("task-done");
                } else {
                    $(this).parents('li').removeClass("task-done");
                }})};


        $(document).ready(function () {
            loadTodos();
            console.log('bindDeleteAction ready');
            bindDeleteAction();
//          这个是显示删除线
            initTaskWidget();


        });

//        $(function () {
//            $("#sortable").sortable();
//            $("#sortable").disableSelection();
//        });

    </script>

</head>


<body>
    <!--导航栏-->
<section id="container">
    <header class="header black-bg">
        <a href="#" class="logo"><b>T o d o</b></a>
        <div class="top-menu">
            <ul class="nav pull-right top-menu">
                <li><a class="logout" href="/logout">Logout</a></li>
            </ul>
        </div>
    </header>

    <!--侧栏-->
    <aside>
        <div id="sidebar" class="nav-collapse ">
            <!-- sidebar menu start-->
            <ul class="sidebar-menu" id="nav-accordion">

                <p class="centered"><a href="#"><img src="../static/img/ui-sam.jpg" class="img-circle"
                                                                width="60"></a></p>
                <h5 class="centered">{{user.username}}</h5>
                <!--<h5 class="centered">{{user.id}}</h5>-->
                <h5 class="centered">{{user.sex}}</h5>
                <h5 class="centered">{{user.note}}</h5>

            </ul>
            <!-- sidebar menu end-->
        </div>
    </aside>

    <!--正文-->
    <section id="main-content">
        <section class="wrapper">
            <h3><i class="fa fa-angle-right"></i> To-Do Lists</h3>

            <div class="row mt mb">
                <div class="col-md-12">
                    <section class="task-panel tasks-widget">
                        <div class="panel-heading">
                            <div class="pull-left"><h5><i class="fa fa-tasks"></i> My Todo List</h5></div>
                            <br>
                        </div>
                        <div class="panel-body">
                            <div class="task-content">
                                <ul id="sortable" class="task-list">
                                    <li id="id-li-list">
                                        <i class=" fa fa-ellipsis-v"></i>
                                        <div class="task-checkbox">
                                            <input type="checkbox" class="list-child" value=""/>
                                        </div>
                                        <div class="task-title">
                                            <span class="task-title-sp">list1</span>
                                            <span class="badge bg-theme">Done</span>
                                            <div class="pull-right hidden-phone">
                                                <button class="btn btn-success btn-xs fa fa-check" title="完成"></button>
                                                <button class="btn btn-primary btn-xs fa fa-pencil" title="编辑"></button>
                                                <button class="btn btn-danger btn-xs fa fa-trash-o long-button-delete" title="删除" data-id="嗯哪"></button>
                                            </div>
                                        </div>
                                    </li>
                                    <!--<li class="list-danger">-->
                                        <!--<i class=" fa fa-ellipsis-v"></i>-->
                                        <!--<div class="task-checkbox">-->
                                            <!--<input type="checkbox" class="list-child" value=""/>-->
                                        <!--</div>-->
                                        <!--<div class="task-title">-->
                                            <!--<span class="task-title-sp">list1</span>-->
                                            <!--&lt;!&ndash;<span class="badge bg-warning">Cool</span>&ndash;&gt;-->
                                            <!--<div class="pull-right hidden-phone">-->
                                                <!--<button class="btn btn-success btn-xs fa fa-check"></button>-->
                                                <!--<button class="btn btn-primary btn-xs fa fa-pencil"></button>-->
                                                <!--<button class="btn btn-danger btn-xs fa fa-trash-o"></button>-->
                                            <!--</div>-->
                                        <!--</div>-->
                                    <!--</li>-->
                                    <!--<li class="list-success">-->
                                        <!--<i class=" fa fa-ellipsis-v"></i>-->
                                        <!--<div class="task-checkbox">-->
                                            <!--<input type="checkbox" class="list-child" value=""/>-->
                                        <!--</div>-->
                                        <!--<div class="task-title">-->
                                            <!--<span class="task-title-sp">Free updates always, no extra fees.</span>-->
                                            <!--&lt;!&ndash;<span class="badge bg-success">2 Days</span>&ndash;&gt;-->
                                            <!--<div class="pull-right hidden-phone">-->
                                                <!--<button class="btn btn-success btn-xs fa fa-check"></button>-->
                                                <!--<button class="btn btn-primary btn-xs fa fa-pencil"></button>-->
                                                <!--<button class="btn btn-danger btn-xs fa fa-trash-o"></button>-->
                                            <!--</div>-->
                                        <!--</div>-->
                                    <!--</li>-->
                                    <!--<li class="list-warning">-->
                                        <!--<i class=" fa fa-ellipsis-v"></i>-->
                                        <!--<div class="task-checkbox">-->
                                            <!--<input type="checkbox" class="list-child" value=""/>-->
                                        <!--</div>-->
                                        <!--<div class="task-title">-->
                                            <!--<span class="task-title-sp">More features coming soon</span>-->
                                            <!--&lt;!&ndash;<span class="badge bg-info">Tomorrow</span>&ndash;&gt;-->
                                            <!--<div class="pull-right hidden-phone">-->
                                                <!--<button class="btn btn-success btn-xs fa fa-check"></button>-->
                                                <!--<button class="btn btn-primary btn-xs fa fa-pencil"></button>-->
                                                <!--<button class="btn btn-danger btn-xs fa fa-trash-o"></button>-->
                                            <!--</div>-->
                                        <!--</div>-->
                                    <!--</li>-->
                                    <!--<li class="list-info">-->
                                        <!--<i class=" fa fa-ellipsis-v"></i>-->
                                        <!--<div class="task-checkbox">-->
                                            <!--<input type="checkbox" class="list-child" value=""/>-->
                                        <!--</div>-->
                                        <!--<div class="task-title">-->
                                            <!--<span class="task-title-sp">Hey, seriously, you should buy this Dashboard</span>-->
                                            <!--&lt;!&ndash;<span class="badge bg-important">Now</span>&ndash;&gt;-->
                                            <!--<div class="pull-right hidden-phone">-->
                                                <!--<button class="btn btn-success btn-xs fa fa-check"></button>-->
                                                <!--<button class="btn btn-primary btn-xs fa fa-pencil"></button>-->
                                                <!--<button class="btn btn-danger btn-xs fa fa-trash-o"></button>-->
                                            <!--</div>-->
                                        <!--</div>-->
                                    <!--</li>-->

                                </ul>
                            </div>
                            <div class=" add-task-row">
                                <a class="btn btn-success btn-sm pull-left" href="todo_list.html#">Add New Tasks</a>
                                <a class="btn btn-default btn-sm pull-right" href="todo_list.html#">See All Tasks</a>
                            </div>
                        </div>
                    </section>
                </div>
            </div>
        </section>
        <! --/wrapper -->
    </section>

    <!--footer-->
    <footer class="site-footer">
        <div class="text-center">
            2014 - Alvarez.is
            <a href="todo_list.html#" class="go-top">
                <i class="fa fa-angle-up"></i>
            </a>
        </div>
    </footer>
</section>

</body>
</html>
